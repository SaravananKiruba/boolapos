<UserControl x:Class="Page_Navigation_App.View.Orders"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
             mc:Ignorable="d"
             d:DesignHeight="600"
             d:DesignWidth="800">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Search Section -->
        <mah:MetroHeader Header="Search Orders">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBox Text="{Binding SearchOrderID, UpdateSourceTrigger=PropertyChanged}"
                         mah:TextBoxHelper.Watermark="Enter Order ID..."
                         Style="{StaticResource MahApps.Styles.TextBox}"
                         Margin="0,0,10,0">
                    <TextBox.InputBindings>
                        <KeyBinding Key="Return" Command="{Binding SearchCommand}"/>
                    </TextBox.InputBindings>
                </TextBox>

                <Button Grid.Column="1"
                        Style="{StaticResource MahApps.Styles.Button.Square.Accent}"
                        Command="{Binding SearchCommand}">
                    <StackPanel Orientation="Horizontal">
                        <iconPacks:PackIconMaterial Kind="Magnify" 
                                                   Margin="0,0,5,0"/>
                        <TextBlock Text="Search"/>
                    </StackPanel>
                </Button>
            </Grid>
        </mah:MetroHeader>

        <!-- Orders List -->
        <mah:MetroHeader Grid.Row="1"
                        Margin="0,20"
                        Header="Orders">
            <DataGrid ItemsSource="{Binding Orders}"
                      SelectedItem="{Binding SelectedOrder}"
                      AutoGenerateColumns="False"
                      Style="{StaticResource MahApps.Styles.DataGrid}"
                      GridLinesVisibility="Horizontal"
                      SelectionMode="Single"
                      IsReadOnly="True">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Order ID" 
                                      Binding="{Binding OrderID}"
                                      Width="100"/>
                    <DataGridTextColumn Header="Customer" 
                                      Binding="{Binding Customer.CustomerName}"
                                      Width="*"/>
                    <DataGridTextColumn Header="Order Date" 
                                      Binding="{Binding OrderDate, StringFormat=d}"
                                      Width="120"/>
                    <DataGridTextColumn Header="Total Amount" 
                                      Binding="{Binding TotalAmount, StringFormat=C}"
                                      Width="120"/>
                    <DataGridTemplateColumn Width="Auto">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Button Style="{StaticResource MahApps.Styles.Button.Circle}"
                                            Width="32"
                                            Height="32"
                                            Margin="0,0,5,0"
                                            ToolTip="View Details"
                                            Command="{Binding DataContext.ViewDetailsCommand, 
                                                    RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                            CommandParameter="{Binding}">
                                        <iconPacks:PackIconMaterial Kind="Eye" Width="16" Height="16"/>
                                    </Button>
                                    <Button Style="{StaticResource MahApps.Styles.Button.Circle}"
                                            Width="32"
                                            Height="32"
                                            ToolTip="Delete"
                                            Command="{Binding DataContext.DeleteOrderCommand, 
                                                    RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                            CommandParameter="{Binding}">
                                        <iconPacks:PackIconMaterial Kind="Delete" Width="16" Height="16"/>
                                    </Button>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </mah:MetroHeader>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="2" 
                  Orientation="Horizontal" 
                  HorizontalAlignment="Right">
            <Button Style="{StaticResource MahApps.Styles.Button.Square}"
                    Command="{Binding ExportCommand}"
                    Margin="0,0,10,0">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconMaterial Kind="FileExport" 
                                               Margin="0,0,5,0"/>
                    <TextBlock Text="Export"/>
                </StackPanel>
            </Button>

            <Button Style="{StaticResource MahApps.Styles.Button.Square.Accent}"
                    Command="{Binding AddOrderCommand}">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconMaterial Kind="Plus" 
                                               Margin="0,0,5,0"/>
                    <TextBlock Text="New Order"/>
                </StackPanel>
            </Button>
        </StackPanel>
    </Grid>
</UserControl>
